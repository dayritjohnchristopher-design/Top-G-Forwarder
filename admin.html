<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Top-G Forwarder Admin</title>
  <!-- Firebase compat SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
  <div class="container py-5">
    <h1 class="mb-4">Admin – Add / Update Tracking</h1>

    <div class="mb-3">
      <label class="form-label">Tracking Number</label>
      <input type="text" id="trackingNumber" class="form-control" placeholder="Enter tracking number">
    </div>

    <div class="mb-3">
      <label class="form-label">Status</label>
      <input type="text" id="status" class="form-control" placeholder="Enter status (e.g. In Transit)">
    </div>

    <div class="mb-3">
      <label class="form-label">Location</label>
      <input type="text" id="location" class="form-control" placeholder="Enter location">
    </div>

    <button onclick="addTracking()" class="btn btn-primary">Save / Update</button>
    <div id="message" class="mt-3"></div>
  </div>

  <script>
    // Firebase config – same as sa index.html
    const firebaseConfig = {
      apiKey: "AIzaSyDo73vN9SU08bLoeHs1U9I-PDBX5kDoSsE",
      authDomain: "top-g-forwarder.firebaseapp.com",
      projectId: "top-g-forwarder",
      storageBucket: "top-g-forwarder.firebasestorage.app",
      messagingSenderId: "79738605812",
      appId: "1:79738605812:web:dabbd01812023936bfcea1",
      measurementId: "G-SJGNXNN89Q"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Function to add or update tracking document
    async function addTracking() {
      const trackingNumber = document.getElementById('trackingNumber').value.trim();
      const status = document.getElementById('status').value.trim();
      const location = document.getElementById('location').value.trim();
      const msg = document.getElementById('message');

      if (!trackingNumber) {
        msg.innerHTML = `<p class="text-danger">Please enter a tracking number.</p>`;
        return;
      }

      try {
        await db.collection('tracking').doc(trackingNumber).set({
          status: status,
          location: location,
          updated: new Date().toISOString()
        });

        msg.innerHTML = `<p class="text-success">Tracking info saved/updated successfully!</p>`;

        // clear fields
        document.getElementById('trackingNumber').value = "";
        document.getElementById('status').value = "";
        document.getElementById('location').value = "";
      } catch (err) {
        console.error(err);
        msg.innerHTML = `<p class="text-danger">Error saving data. Check console.</p>`;
      }
    }
  </script>
</body>
</html>
